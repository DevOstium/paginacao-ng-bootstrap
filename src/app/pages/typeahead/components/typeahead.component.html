<h1>TypeAhead</h1>


<form class="example-form" [formGroup]='usersForm'>
     
    <mat-form-field class="example-full-width">
          <input matInput 
                 placeholder="Choose a user" 
                 [matAutocomplete]="auto" 
                 formControlName='userInput'
                 (keyup)="pesquisa.next($event.target.value)"
                 >
    </mat-form-field>

    <span>Your choice is: {{usersForm.get('userInput').value | json}}</span>
  
    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">

          <mat-option *ngIf="isLoading" class="is-loading"><mat-spinner diameter="50"></mat-spinner></mat-option>

          <ng-container *ngIf="!isLoading">
              <mat-option *ngFor="let user of filteredUsers" [value]="user">
                      <span (click)="loadTable(user.nome)" >{{ user.nome }}</span>
                      <small  > | ID: {{user.id}}</small>
              </mat-option>
          </ng-container>

    </mat-autocomplete>


    <table class="lessons-table mat-elevation-z7" *ngIf="(table$ | async) as items">

        <thead>
            <th>#</th>
            <th>Description</th>
            <th>Duration</th>
        </thead>

        <tr *ngFor="let i of items">
            <td class="seqno-cell">{{i.id}}</td>
            <td class="description-cell">{{i.nome}}</td>
        </tr>

    </table>

</form>